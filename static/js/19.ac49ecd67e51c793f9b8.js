webpackJsonp([19],{DmZq:function(e,t,a){"use strict";function o(e){a("LqWB"),a("W2WL")}Object.defineProperty(t,"__esModule",{value:!0});var s=a("hhm8"),n=a("P9l9"),i=a("OIV/"),l=a("as7l"),d=(a("7t+N"),a("rHil")),r=a("pDNl"),u=a("ALGc"),c=a("2sLL"),m=a("1sNz"),p=a("YxJB"),g=a("3Lt7"),h=a("+zLN"),f=a("Bfwr"),b=a("63CM"),v=(b.a,d.a,r.a,u.a,c.a,m.a,i.a,l.a,p.a,g.a,h.a,f.a,{directives:{TransferDom:b.a},components:{Group:d.a,XInput:r.a,XTextarea:u.a,XButton:c.a,ViewBox:m.a,OFooter:i.a,OUploader:l.a,Flexbox:p.a,FlexboxItem:g.a,AlertModule:h.a,Loading:f.a},data:function(){return{list:[],data:{},pageData:{},propUploaderTitle:"上传图片",propLableStyle:{width:"6.5em",textAlign:"justify",marginRight:"2em"},propMaxCount:50,uploadList:[],propSuccessImgList:[],disabledButton:!1,reqUploadList:[],submintState:"",pageIndex:0,pageSize:2,loadingShow:!1,loadingText:"请求中",imgMax:0,imgCount:0,isDefault:!1}},created:function(){},watch:{},methods:{replaceValue:function(e){this.data.FeedbackComment=e.replace(/ /g,"").replace(/\u2006/g,"")},getFeedbackDetail:function(){var e=this,t={params:{RuleName:"GetFeedbackEventDetail",Parm:{EventNo:this.pageData.eventNo}}},a=function(t){"00"==t.ReturnCd?e.data=t.RspMsg.result.ListItems.ListItem[0]:e.showModule("获取数据失败",t.RspMsg.msg),"1"!=e.pageData.feedbackStatus&&(e.loadingShow=!1)};Object(n.a)(t,a)},getImageItems:function(){var e=this;if(0!=this.loadingShow){this.pageIndex++;var t={params:{RuleName:"GetImageItems",Parm:{CaseNo:this.pageData.eventNo,PageSize:this.pageSize,PageIndex:this.pageIndex}}},a=function(t){"00"==t.ReturnCd?(e.propSuccessImgList=e.propSuccessImgList.concat(t.RspMsg.result.ListItems.ListItem||[]),setTimeout(function(){e.imgMax=t.RspMsg.total,e.imgCount=e.imgCount+t.RspMsg.result.ListItems.ListItem.length,t.RspMsg.result.ListItems.ListItem&&e.imgCount!=t.RspMsg.total&&t.RspMsg.result.ListItems.ListItem.length==e.pageSize?e.getImageItems():e.loadingShow=!1},10)):(e.loadingShow=!1,e.showModule("获取图片失败",t.RspMsg.msg))},o=function(t){e.loadingShow=!1,e.showToast("获取图片失败","20.0em","warn")};Object(n.a)(t,a,o)}},showModule:function(e,t){h.a.show({title:e,content:t,onShow:function(){},onHide:function(){}})},showToast:function(e,t,a){this.$vux.toast.show({text:e,type:a,width:t})},getUploadList:function(e){this.uploadList=e},handleInputEvent:function(e){var t=this;this.submintState=e;var a="01"==e?"录入预警查证反馈意见保存失败":"录入预警查证反馈意见提交失败";if(""==this.data.FeedbackComment)return void this.showToast("请输入查证反馈意见","10.0em","cancel");this.loadingText="请求中",this.loadingShow=!0,this.isDefault=!1,this.disabledButton=!0;var o=this,i={params:{RuleName:"HandleFeedbackEvent",Parm:{TimePoint:Object(s.a)(new Date,"yyyyMMdd"),EventNo:this.pageData.eventNo,FeedbackComment:this.data.FeedbackComment,HandleState:e}}},l=function(e){if("00"==e.ReturnCd&&"01"==e.RspMsg.result[0].DataFlag){if(t.$refs.uploader.addImgCount>0){for(var s=0;s<t.uploadList.length;s++){var n=t.uploadList[s];n.ImageId<0&&t.reqUploadList.push({ImageId:n.ImageId,FileName:n.FileName,FileContent:n.src.slice(23)})}t.imgMax=t.reqUploadList.length,t.imgCount=0,t.handleImageItems()}else t.loadingShow=!1,t.$vux.toast.show({text:"01"==t.submintState?"录入预警查证反馈意见保存成功":"录入预警查证反馈意见提交成功",width:"15em",onHide:function(){o.$router.go(-1)}});t.$refs.uploader.deleteImgList.length>0&&t.deleteHandleImageItems()}else t.loadingShow=!1,t.showModule(a,e.RspMsg.msg),t.disabledButton=!1},d=function(e){t.loadingShow=!1,t.showModule(a,e.RspMsg.msg),t.disabledButton=!1};Object(n.a)(i,l,d)},handleImageItems:function(){var e=this,t=this,a=this.reqUploadList.splice(0,2);this.loadingText="上传图片中",this.isDefault=!0,this.imgCount=this.imgCount+a.length;var o={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.pageData.eventNo,HandleState:"02",ListItems:{ListItem:a}}}},s=function(a){"00"==a.ReturnCd&&"01"==a.RspMsg.result[0].DataFlag?e.reqUploadList.length>0?e.handleImageItems():(e.loadingShow=!1,e.$vux.toast.show({text:"01"==e.submintState?"录入预警查证反馈意见保存成功":"录入预警查证反馈意见提交成功",width:"15em",onHide:function(){t.$router.go(-1)}})):(e.loadingShow=!1,e.showModule("上传图片失败",a.RspMsg.msg))},i=function(t){e.loadingShow=!1,e.showToast("上传图片失败","20.0em","warn")};Object(n.a)(o,s,i)},deleteHandleImageItems:function(){var e=this,t={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.pageData.eventNo,HandleState:"04",ListItems:{ListItem:this.$refs.uploader.deleteImgList}}}},a=function(e){"00"==e.ReturnCd&&"01"==e.RspMsg.result[0].DataFlag||_this.showModule("删除图片失败",e.RspMsg.msg)},o=function(t){e.loadingShow=!1,e.showToast("删除图片失败","20.0em","warn")};Object(n.a)(t,a,o)},getImgCount:function(){return this.imgCount+"/"+this.imgMax}},mounted:function(){},beforeRouteEnter:function(e,t,a){a(function(e){e.loadingText="加载中",e.loadingShow=!0,e.isDefault=!1,e.list=[],e.data={},e.uploadList=[],e.propSuccessImgList=[],e.disabledButton=!1,e.pageIndex=0,e.$refs.uploader.addImgCount=0,e.reqUploadList=[],e.submintState="",e.pageData.eventNo=e.$route.query.eventNo,e.pageData.feedbackStatus=e.$route.query.feedbackStatus,e.$refs.uploader.deleteImgList=[],e.imgMax=0,e.imgCount=0,e.getFeedbackDetail(),"1"==e.pageData.feedbackStatus&&(e.loadingText="图片加载中",e.isDefault=!0,e.getImageItems())})},beforeRouteLeave:function(e,t,a){"0"==window.sessionStorage.getItem("isClickImg")?(this.loadingShow=!1,a()):(this.$refs.uploader.$refs.previewer.close(),a(!1))}}),I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view-box",{staticStyle:{"background-color":"#fff"},attrs:{"body-padding-bottom":"93px"}},[a("group",{staticClass:"check-feedback",attrs:{gutter:"0em","label-width":"6.5em","label-margin-right":"1.5em","label-align":"justify"}},[a("x-input",{attrs:{title:"规则名称",readonly:""},model:{value:e.data.RuleName,callback:function(t){e.$set(e.data,"RuleName",t)},expression:"data.RuleName"}}),e._v(" "),a("x-input",{attrs:{title:"预警提示日期",readonly:""},model:{value:e.data.AlertDate,callback:function(t){e.$set(e.data,"AlertDate",t)},expression:"data.AlertDate"}}),e._v(" "),a("x-input",{attrs:{title:"预警提示对象",readonly:""},model:{value:e.data.PrimaryObjectNo,callback:function(t){e.$set(e.data,"PrimaryObjectNo",t)},expression:"data.PrimaryObjectNo"}}),e._v(" "),a("x-textarea",{attrs:{title:"预警描述",readonly:"","show-counter":!1,rows:3},model:{value:e.data.EventDescription,callback:function(t){e.$set(e.data,"EventDescription",t)},expression:"data.EventDescription"}}),e._v(" "),a("x-textarea",{attrs:{placeholder:"请输入",title:"查证反馈意见","show-counter":!1,rows:5},on:{"on-change":e.replaceValue},model:{value:e.data.FeedbackComment,callback:function(t){e.$set(e.data,"FeedbackComment",t)},expression:"data.FeedbackComment"}}),e._v(" "),a("o-uploader",{ref:"uploader",attrs:{propUploaderTitle:e.propUploaderTitle,propMaxCount:e.propMaxCount,propSuccessImgList:e.propSuccessImgList,propLableStyle:e.propLableStyle},on:{"get-uploadlist":e.getUploadList}})],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"div_flexbox_pos check-feedback"},[a("flexbox",[a("flexbox-item",[a("x-button",{attrs:{disabled:e.disabledButton,type:"primary"},nativeOn:{click:function(t){e.handleInputEvent("01")}}},[e._v("保存")])],1),e._v(" "),a("flexbox-item",[a("x-button",{attrs:{disabled:e.disabledButton,type:"primary"},nativeOn:{click:function(t){e.handleInputEvent("02")}}},[e._v("提交")])],1)],1)],1),e._v(" "),a("o-footer",{attrs:{slot:"bottom",title:"录入预警查证反馈意见"},slot:"bottom"}),e._v(" "),a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[a("loading",{attrs:{show:e.loadingShow,text:e.loadingText}},[e.isDefault?a("div",{attrs:{slot:"default"},domProps:{innerHTML:e._s(e.getImgCount())},slot:"default"}):e._e()])],1)],1)},x=[],w={render:I,staticRenderFns:x},L=w,C=a("VU/8"),S=o,k=C(v,L,!1,S,"data-v-0f9ce72c",null);t.default=k.exports},LqWB:function(e,t,a){var o=a("dwDR");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("5c1b4e74",o,!0,{})},"U/zQ":function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,"\n.check-feedback .weui-cells,\n.check-feedback .weui-btn {\n    font-size: 16px !important;\n}\n","",{version:3,sources:["F:/OICS/src/oics/warning_processing/check_feedback.vue"],names:[],mappings:";AACA;;IAEI,2BAA2B;CAC9B",file:"check_feedback.vue",sourcesContent:["\n.check-feedback .weui-cells,\n.check-feedback .weui-btn {\n    font-size: 16px !important;\n}\n"],sourceRoot:""}])},W2WL:function(e,t,a){var o=a("U/zQ");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("3806ea08",o,!0,{})},dwDR:function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,"\n.weui-cell[data-v-0f9ce72c] {\n    padding: 12px 15px;\n}\n","",{version:3,sources:["F:/OICS/src/oics/warning_processing/check_feedback.vue"],names:[],mappings:";AACA;IACI,mBAAmB;CACtB",file:"check_feedback.vue",sourcesContent:["\n.weui-cell[data-v-0f9ce72c] {\n    padding: 12px 15px;\n}\n"],sourceRoot:""}])}});
//# sourceMappingURL=19.ac49ecd67e51c793f9b8.js.map