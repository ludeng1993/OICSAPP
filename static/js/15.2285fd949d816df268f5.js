webpackJsonp([15],{"0pCO":function(e,t,i){t=e.exports=i("FZ+f")(!0),t.push([e.i,"\n.weui-cell[data-v-6799e842] {\n    padding: 15px 15px;\n}\n","",{version:3,sources:["F:/OICS/src/oics/site_inspections/site_inspection_handle.vue"],names:[],mappings:";AACA;IACI,mBAAmB;CACtB",file:"site_inspection_handle.vue",sourcesContent:["\n.weui-cell[data-v-6799e842] {\n    padding: 15px 15px;\n}\n"],sourceRoot:""}])},"B/d5":function(e,t,i){"use strict";function n(e){i("VmBv"),i("g9oh")}Object.defineProperty(t,"__esModule",{value:!0});var s=i("hhm8"),o=i("P9l9"),a=i("OIV/"),l=i("as7l"),c=i("rHil"),u=i("pDNl"),r=i("ALGc"),p=i("2sLL"),d=i("1sNz"),m=i("etVR"),g=i("+zLN"),h=i("Bfwr"),I=i("63CM"),f=(I.a,c.a,u.a,r.a,p.a,d.a,m.a,a.a,l.a,g.a,h.a,{directives:{TransferDom:I.a},components:{Group:c.a,XInput:u.a,XTextarea:r.a,XButton:p.a,ViewBox:d.a,Checklist:m.a,OFooter:a.a,OUploader:l.a,AlertModule:g.a,Loading:h.a},data:function(){return{siteInspectionItem:{},RSLTRESULTList:[{key:"11",value:"有问题"},{key:"21",value:"无问题"},{key:"31",value:"无此业务"}],RSLTRESULT:[],propUploaderTitle:"上传图片",propLableStyle:{width:"4.5em",textAlign:"justify",marginRight:"1.5em"},propMaxCount:10,uploadList:[],propSuccessImgList:[],disabledButton:!1,reqUploadList:[],pageIndex:0,pageSize:2,loadingShow:!1,loadingText:"请求中",imgMax:0,imgCount:0,isDefault:!1}},created:function(){},methods:{getImageItems:function(){var e=this;if(0!=this.loadingShow){this.pageIndex++;var t={params:{RuleName:"GetImageItems",Parm:{CaseNo:this.siteInspectionItem.EXECUTEKEY+"_"+this.siteInspectionItem.RSLTKEY,PageSize:this.pageSize,PageIndex:this.pageIndex}}},i=function(t){"00"==t.ReturnCd?(e.propSuccessImgList=e.propSuccessImgList.concat(t.RspMsg.result.ListItems.ListItem||[]),setTimeout(function(){e.imgMax=t.RspMsg.total,e.imgCount=e.imgCount+t.RspMsg.result.ListItems.ListItem.length,t.RspMsg.result.ListItems.ListItem&&e.imgCount!=t.RspMsg.total&&t.RspMsg.result.ListItems.ListItem.length==e.pageSize?e.getImageItems():e.loadingShow=!1},10)):(e.loadingShow=!1,e.showModule("获取检查影像失败",t.RspMsg.msg))},n=function(t){e.loadingShow=!1,e.showToast("获取检查影像失败","20.0em","warn")};Object(o.a)(t,i,n)}},showModule:function(e,t){g.a.show({title:e,content:t,onShow:function(){},onHide:function(){}})},showToast:function(e,t,i){this.$vux.toast.show({text:e,type:i,width:t})},getUploadList:function(e){this.uploadList=e},handleSiteInspection:function(e){var t=this;if(this.RSLTRESULT.length<=0)return void this.showToast("请选择检查结论","8.0em","cancel");if("11"==this.RSLTRESULT[0]&&""==this.siteInspectionItem.DESCR)return void this.showToast("请输入检查描述","8.0em","cancel");this.loadingText="请求中",this.loadingShow=!0,this.isDefault=!1,this.disabledButton=!0;var i=this,n={params:{RuleName:"HandleSiteInspection",Parm:{TimePoint:Object(s.a)(new Date,"yyyyMMdd"),EXECUTEKEY:this.siteInspectionItem.EXECUTEKEY,FRSLTKEY:this.siteInspectionItem.FRSLTKEY,RSLTKEY:this.siteInspectionItem.RSLTKEY,RSLTRESULT:this.RSLTRESULT[0],DESCR:this.siteInspectionItem.DESCR,WorkState:e}}},a=function(e){if("00"==e.ReturnCd&&"01"==e.RspMsg.result[0].DataFlag){if(t.$refs.uploader.addImgCount>0){for(var n=0;n<t.uploadList.length;n++){var s=t.uploadList[n];s.ImageId<0&&t.reqUploadList.push({ImageId:s.ImageId,FileName:s.FileName,FileContent:s.src.slice(23)})}t.imgMax=t.reqUploadList.length,t.imgCount=0,t.handleImageItems()}else t.loadingShow=!1,i.$vux.toast.show({text:"保存成功",width:"6em",onHide:function(){i.localStorageRemoveItem(),i.$router.go(-1)}});t.$refs.uploader.deleteImgList.length>0&&t.deleteHandleImageItems()}else t.loadingShow=!1,t.showModule("保存失败",e.RspMsg.msg),t.disabledButton=!1},l=function(e){t.loadingShow=!1,t.showModule("保存失败",e.RspMsg.msg),t.disabledButton=!1};Object(o.a)(n,a,l)},onBack:function(){this.localStorageRemoveItem()},onHomeMenu:function(){this.localStorageRemoveItem()},localStorageRemoveItem:function(){localStorage.removeItem("SiteInspectionItem")},handleImageItems:function(){var e=this,t=this,i=this.reqUploadList.splice(0,2);this.loadingText="上传图片中",this.isDefault=!0,this.imgCount=this.imgCount+i.length;var n={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.siteInspectionItem.EXECUTEKEY+"_"+this.siteInspectionItem.RSLTKEY,HandleState:"02",ListItems:{ListItem:i}}}},s=function(i){"00"==i.ReturnCd&&"01"==i.RspMsg.result[0].DataFlag?e.reqUploadList.length>0?e.handleImageItems():(e.loadingShow=!1,t.$vux.toast.show({text:"保存成功",width:"6em",onHide:function(){t.localStorageRemoveItem(),t.$router.go(-1)}})):(e.loadingShow=!1,e.showModule("上传图片失败",i.RspMsg.msg))},a=function(t){e.loadingShow=!1,e.showToast("上传图片失败","20.0em","warn")};Object(o.a)(n,s,a)},deleteHandleImageItems:function(){var e=this,t={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.siteInspectionItem.EXECUTEKEY+"_"+this.siteInspectionItem.RSLTKEY,HandleState:"04",ListItems:{ListItem:this.$refs.uploader.deleteImgList}}}},i=function(e){"00"==e.ReturnCd&&"01"==e.RspMsg.result[0].DataFlag||_this.showModule("删除图片失败",e.RspMsg.msg)},n=function(t){e.loadingShow=!1,e.showToast("删除图片失败","20.0em","warn")};Object(o.a)(t,i,n)},getImgCount:function(){return this.imgCount+"/"+this.imgMax}},mounted:function(){},beforeRouteEnter:function(e,t,i){i(function(e){e.loadingText="加载中",e.loadingShow=!0,e.isDefault=!1,e.uploadList=[],e.propSuccessImgList=[],e.RSLTRESULT=[],e.disabledButton=!1,e.pageIndex=0,e.$refs.uploader.addImgCount=0,e.reqUploadList=[],e.$refs.uploader.deleteImgList=[],e.imgMax=0,e.imgCount=0,e.siteInspectionItem=JSON.parse(localStorage.getItem("SiteInspectionItem")),""!=e.siteInspectionItem.RSLTRESULT&&e.RSLTRESULT.push(e.siteInspectionItem.RSLTRESULT),"1"==e.siteInspectionItem.FLAG?(e.loadingText="图片加载中",e.isDefault=!0,e.getImageItems()):e.loadingShow=!1})},beforeRouteLeave:function(e,t,i){"0"==window.sessionStorage.getItem("isClickImg")?(this.loadingShow=!1,i()):(this.$refs.uploader.$refs.previewer.close(),i(!1))}}),w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("view-box",{staticStyle:{"background-color":"#fff"},attrs:{"body-padding-bottom":"55px"}},[i("group",{staticClass:"site_inspection_handle",attrs:{gutter:"0em","label-width":"4.5em","label-margin-right":"1.5em","label-align":"justify"}},[i("x-textarea",{attrs:{title:"检查要点",readonly:"","show-counter":!1,rows:5},model:{value:e.siteInspectionItem.RTITLE,callback:function(t){e.$set(e.siteInspectionItem,"RTITLE",t)},expression:"siteInspectionItem.RTITLE"}}),e._v(" "),i("x-textarea",{attrs:{title:"检查描述",placeholder:"请输入","show-counter":!1,rows:5},on:{"on-change":e.replaceValue},model:{value:e.siteInspectionItem.DESCR,callback:function(t){e.$set(e.siteInspectionItem,"DESCR",t)},expression:"siteInspectionItem.DESCR"}}),e._v(" "),i("o-uploader",{ref:"uploader",attrs:{propUploaderTitle:e.propUploaderTitle,propMaxCount:e.propMaxCount,propSuccessImgList:e.propSuccessImgList,propLableStyle:e.propLableStyle},on:{"get-uploadlist":e.getUploadList}}),e._v(" "),i("div",[i("div",{staticClass:"vux-x-input weui-cell"},[i("div",{staticClass:"weui-cell__hd"},[i("label",{staticClass:"weui-label vux-cell-justify",staticStyle:{width:"4.5em","text-align":"justify","margin-right":"1.5em"}},[e._v("检查结论")])]),e._v(" "),i("div",{staticClass:"weui-cell__bd weui-cell__primary"},[i("checklist",{staticClass:"weui_cells_fu",attrs:{options:e.RSLTRESULTList,max:1},model:{value:e.RSLTRESULT,callback:function(t){e.RSLTRESULT=t},expression:"RSLTRESULT"}})],1)])])],1),e._v(" "),i("br"),e._v(" "),i("div",{staticClass:"div_flexbox_pos site_inspection_handle"},[i("x-button",{attrs:{type:"primary",disabled:e.disabledButton},nativeOn:{click:function(t){e.handleSiteInspection("01")}}},[e._v("保存")])],1),e._v(" "),i("o-footer",{attrs:{slot:"bottom",title:"现场检查待办任务处理"},on:{"on-back":e.onBack,"on-homeMenu":e.onHomeMenu},slot:"bottom"}),e._v(" "),i("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[i("loading",{attrs:{show:e.loadingShow,text:e.loadingText}},[e.isDefault?i("div",{attrs:{slot:"default"},domProps:{innerHTML:e._s(e.getImgCount())},slot:"default"}):e._e()])],1)],1)},S=[],x={render:w,staticRenderFns:S},_=x,L=i("VU/8"),C=n,R=L(f,_,!1,C,"data-v-6799e842",null);t.default=R.exports},VmBv:function(e,t,i){var n=i("0pCO");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("75693598",n,!0,{})},WkLQ:function(e,t,i){t=e.exports=i("FZ+f")(!0),t.push([e.i,"\n.site_inspection_handle .weui-cells,\n.site_inspection_handle .weui-btn {\n    font-size: 16px !important;\n}\n.weui-cells_checkbox .weui-check:checked+.weui-icon-checked:before {\n    color: #00a0ea !important;\n}\n\n/*检查结论样式*/\n.weui_cells_fu .weui-cells:before,\n.weui_cells_fu .weui-cells:after,\n.weui_cells_fu .weui-cell:before {\n    /* border-top: 0px solid #D9D9D9!important; */\n    border-width: 0px;\n}\n.weui_cells_fu .weui-cell {\n    padding: 0px 10px 0px 0px;\n    display: -webkit-inline-box;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n}\n.weui_cells_fu .weui-cells_checkbox .weui-cell__hd {\n    padding-right: 0;\n}\n.weui_cells_fu .weui-cells_checkbox .weui-icon-checked:before {\n    font-size: 14px;\n}\n\n/*完成情况概述 上边框*/\n\n/* .x_textarea_weui_cell .weui-cell:before {\n    border-top: 0px solid #D9D9D9 !important;\n} */\n","",{version:3,sources:["F:/OICS/src/oics/site_inspections/site_inspection_handle.vue"],names:[],mappings:";AACA;;IAEI,2BAA2B;CAC9B;AACD;IACI,0BAA0B;CAC7B;;AAED,UAAU;AACV;;;IAGI,8CAA8C;IAC9C,kBAAkB;CACrB;AACD;IACI,0BAA0B;IAC1B,4BAA4B;IAC5B,4BAA4B;IAC5B,qBAAqB;CACxB;AACD;IACI,iBAAiB;CACpB;AACD;IACI,gBAAgB;CACnB;;AAED,cAAc;;AAEd;;IAEI",file:"site_inspection_handle.vue",sourcesContent:["\n.site_inspection_handle .weui-cells,\n.site_inspection_handle .weui-btn {\n    font-size: 16px !important;\n}\n.weui-cells_checkbox .weui-check:checked+.weui-icon-checked:before {\n    color: #00a0ea !important;\n}\n\n/*检查结论样式*/\n.weui_cells_fu .weui-cells:before,\n.weui_cells_fu .weui-cells:after,\n.weui_cells_fu .weui-cell:before {\n    /* border-top: 0px solid #D9D9D9!important; */\n    border-width: 0px;\n}\n.weui_cells_fu .weui-cell {\n    padding: 0px 10px 0px 0px;\n    display: -webkit-inline-box;\n    display: -ms-inline-flexbox;\n    display: inline-flex;\n}\n.weui_cells_fu .weui-cells_checkbox .weui-cell__hd {\n    padding-right: 0;\n}\n.weui_cells_fu .weui-cells_checkbox .weui-icon-checked:before {\n    font-size: 14px;\n}\n\n/*完成情况概述 上边框*/\n\n/* .x_textarea_weui_cell .weui-cell:before {\n    border-top: 0px solid #D9D9D9 !important;\n} */\n"],sourceRoot:""}])},g9oh:function(e,t,i){var n=i("WkLQ");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("745ad77a",n,!0,{})}});
//# sourceMappingURL=15.2285fd949d816df268f5.js.map