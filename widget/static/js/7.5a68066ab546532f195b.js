webpackJsonp([7],{"2gVm":function(t,e,o){"use strict";function a(t){o("qhHz"),o("CGdZ")}Object.defineProperty(e,"__esModule",{value:!0});var s=o("hhm8"),n=o("P9l9"),i=o("OIV/"),r=o("IRDH"),l=o("as7l"),d=o("rHil"),u=o("pDNl"),c=o("ALGc"),m=o("2sLL"),p=o("1sNz"),h=o("YxJB"),g=o("3Lt7"),f=o("+zLN"),I=o("Bfwr"),x=o("63CM"),k=(x.a,r.a,d.a,u.a,c.a,m.a,p.a,i.a,l.a,h.a,g.a,f.a,I.a,{directives:{TransferDom:x.a},components:{OPosition:r.a,Group:d.a,XInput:u.a,XTextarea:c.a,XButton:m.a,ViewBox:p.a,OFooter:i.a,OUploader:l.a,Flexbox:h.a,FlexboxItem:g.a,AlertModule:f.a,Loading:I.a},data:function(){return{todayWeekMonthTaskItem:{},propUploaderTitle:"上传图片",propLableStyle:{width:"6.5em",textAlign:"justify",marginRight:"2em"},propMaxCount:10,uploadList:[],propSuccessImgList:[],disabledButton:!1,reqUploadList:[],submintState:"",pageIndex:0,pageSize:2,loadingShow:!1,loadingText:"请求中",imgMax:0,imgCount:0,isDefault:!1}},created:function(){},methods:{replaceValue:function(t){this.todayWeekMonthTaskItem.WorkDesc=t.replace(/ /g,"").replace(/\u2006/g,"")},getImageItems:function(){var t=this;if(0!=this.loadingShow){this.pageIndex++;var e={params:{RuleName:"GetImageItems",Parm:{CaseNo:this.todayWeekMonthTaskItem.TaskNo,PageSize:this.pageSize,PageIndex:this.pageIndex}}},o=function(e){"00"==e.ReturnCd?(t.propSuccessImgList=t.propSuccessImgList.concat(e.RspMsg.result.ListItems.ListItem||[]),setTimeout(function(){t.imgMax=e.RspMsg.total,t.imgCount=t.imgCount+e.RspMsg.result.ListItems.ListItem.length,e.RspMsg.result.ListItems.ListItem&&t.imgCount!=e.RspMsg.total&&e.RspMsg.result.ListItems.ListItem.length==t.pageSize?t.getImageItems():t.loadingShow=!1},10)):(t.loadingShow=!1,t.showModule("获取任务影像失败",e.RspMsg.msg))},a=function(e){t.loadingShow=!1,t.showToast("获取任务影像失败","20.0em","warn")};Object(n.a)(e,o,a)}},showModule:function(t,e){f.a.show({title:t,content:e,onShow:function(){},onHide:function(){}})},showToast:function(t,e,o){this.$vux.toast.show({text:t,type:o,width:e})},getUploadList:function(t){this.uploadList=t},handleTask:function(t){var e=this;this.submintState=t;var o="01"==t?"任务处理保存失败":"任务处理提交失败";if(""==this.todayWeekMonthTaskItem.WorkDesc)return void this.showToast("请输入完成情况简述","10.0em","cancel");this.loadingText="请求中",this.loadingShow=!0,this.isDefault=!1,this.disabledButton=!0;var a=this,i={params:{RuleName:"HandleTask",Parm:{TimePoint:Object(s.a)(new Date,"yyyyMMdd"),TaskNo:this.todayWeekMonthTaskItem.TaskNo,WorkDesc:this.todayWeekMonthTaskItem.WorkDesc,HandleState:t}}},r=function(t){if("00"==t.ReturnCd&&"01"==t.RspMsg.result[0].DataFlag){if(e.$refs.uploader.addImgCount>0){for(var s=0;s<e.uploadList.length;s++){var n=e.uploadList[s];n.ImageId<0&&e.reqUploadList.push({ImageId:n.ImageId,FileName:n.FileName,FileContent:n.src.slice(23)})}e.imgMax=e.reqUploadList.length,e.imgCount=0,e.handleImageItems()}else e.loadingShow=!1,e.$vux.toast.show({text:"01"==e.submintState?"任务处理保存成功":"任务处理提交成功",width:"10em",onHide:function(){a.localStorageRemoveItem(),a.$router.go(-1)}});e.$refs.uploader.deleteImgList.length>0&&e.deleteHandleImageItems()}else e.loadingShow=!1,e.showModule(o,t.RspMsg.msg),e.disabledButton=!1},l=function(t){e.loadingShow=!1,e.showModule(o,t.RspMsg.msg),e.disabledButton=!1};Object(n.a)(i,r,l)},onBack:function(){this.localStorageRemoveItem()},onHomeMenu:function(){this.localStorageRemoveItem()},localStorageRemoveItem:function(){localStorage.removeItem("TodayWeekMonthTaskItem")},handleImageItems:function(){var t=this,e=this,o=this.reqUploadList.splice(0,2);this.loadingText="上传图片中",this.isDefault=!0,this.imgCount=this.imgCount+o.length;var a={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.todayWeekMonthTaskItem.TaskNo,HandleState:"02",ListItems:{ListItem:o}}}},s=function(o){"00"==o.ReturnCd&&"01"==o.RspMsg.result[0].DataFlag?t.reqUploadList.length>0?t.handleImageItems():(t.loadingShow=!1,t.$vux.toast.show({text:"01"==t.submintState?"任务处理保存成功":"任务处理提交成功",width:"10em",onHide:function(){e.localStorageRemoveItem(),e.$router.go(-1)}})):(t.loadingShow=!1,t.showModule("上传图片失败",o.RspMsg.msg))},i=function(e){t.loadingShow=!1,t.showToast("上传图片失败","20.0em","warn")};Object(n.a)(a,s,i)},deleteHandleImageItems:function(){var t=this,e={params:{RuleName:"HandleImageItems",Parm:{CaseNo:this.todayWeekMonthTaskItem.TaskNo,HandleState:"04",ListItems:{ListItem:this.$refs.uploader.deleteImgList}}}},o=function(t){"00"==t.ReturnCd&&"01"==t.RspMsg.result[0].DataFlag||_this.showModule("删除图片失败",t.RspMsg.msg)},a=function(e){t.loadingShow=!1,t.showToast("删除图片失败","20.0em","warn")};Object(n.a)(e,o,a)},getImgCount:function(){return this.imgCount+"/"+this.imgMax}},mounted:function(){},beforeRouteEnter:function(t,e,o){o(function(t){t.loadingText="加载中",t.loadingShow=!0,t.isDefault=!1,t.uploadList=[],t.propSuccessImgList=[],t.disabledButton=!1,t.pageIndex=0,t.$refs.uploader.addImgCount=0,t.reqUploadList=[],t.submintState="",t.$refs.uploader.deleteImgList=[],t.imgMax=0,t.imgCount=0,t.todayWeekMonthTaskItem=JSON.parse(localStorage.getItem("TodayWeekMonthTaskItem")),"1"==t.todayWeekMonthTaskItem.TaskState?(t.loadingText="图片加载中",t.isDefault=!0,t.getImageItems()):t.loadingShow=!1})},beforeRouteLeave:function(t,e,o){"0"==window.sessionStorage.getItem("isClickImg")?(this.loadingShow=!1,o()):(this.$refs.uploader.$refs.previewer.close(),o(!1))}}),v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view-box",{staticStyle:{"background-color":"#fff"},attrs:{"body-padding-bottom":"55px"}},[o("group",{staticClass:"track_details",attrs:{gutter:"0em","label-width":"6.5em","label-margin-right":"1.5em","label-align":"justify"}},[o("x-textarea",{attrs:{title:"事项名称",readonly:"","show-counter":!1,rows:3},model:{value:t.todayWeekMonthTaskItem.TaskName,callback:function(e){t.$set(t.todayWeekMonthTaskItem,"TaskName",e)},expression:"todayWeekMonthTaskItem.TaskName"}}),t._v(" "),o("x-textarea",{attrs:{title:"执行要求",readonly:"","show-counter":!1,rows:3},model:{value:t.todayWeekMonthTaskItem.ExeDesc,callback:function(e){t.$set(t.todayWeekMonthTaskItem,"ExeDesc",e)},expression:"todayWeekMonthTaskItem.ExeDesc"}}),t._v(" "),o("o-uploader",{ref:"uploader",attrs:{propUploaderTitle:t.propUploaderTitle,propMaxCount:t.propMaxCount,propSuccessImgList:t.propSuccessImgList,propLableStyle:t.propLableStyle},on:{"get-uploadlist":t.getUploadList}}),t._v(" "),o("div",{staticClass:"x_textarea_weui_cell"},[o("x-textarea",{attrs:{title:"完成情况简述",placeholder:"请输入","show-counter":!1,rows:5},on:{"on-change":t.replaceValue},model:{value:t.todayWeekMonthTaskItem.WorkDesc,callback:function(e){t.$set(t.todayWeekMonthTaskItem,"WorkDesc",e)},expression:"todayWeekMonthTaskItem.WorkDesc"}})],1)],1),t._v(" "),o("br"),t._v(" "),o("flexbox",{staticClass:"div_flexbox_pos track_details",attrs:{slot:"bottom"},slot:"bottom"},[o("flexbox-item",[o("x-button",{attrs:{disabled:t.disabledButton,type:"primary"},nativeOn:{click:function(e){t.handleTask("01")}}},[t._v("保存")])],1),t._v(" "),o("flexbox-item",[o("x-button",{attrs:{disabled:t.disabledButton,type:"primary"},nativeOn:{click:function(e){t.handleTask("02")}}},[t._v("提交")])],1)],1),t._v(" "),o("o-footer",{attrs:{slot:"bottom",title:"任务详细"},on:{"on-back":t.onBack,"on-homeMenu":t.onHomeMenu},slot:"bottom"}),t._v(" "),o("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[o("loading",{attrs:{show:t.loadingShow,text:t.loadingText}},[t.isDefault?o("div",{attrs:{slot:"default"},domProps:{innerHTML:t._s(t.getImgCount())},slot:"default"}):t._e()])],1)],1)},C=[],w={render:v,staticRenderFns:C},b=w,A=o("VU/8"),M=a,S=A(k,b,!1,M,"data-v-6471984e",null);e.default=S.exports},CGdZ:function(t,e,o){var a=o("adXz");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("5857d996",a,!0,{})},FXN4:function(t,e,o){e=t.exports=o("FZ+f")(!0),e.push([t.i,"\n.vux-header .vux-header-left,\r\n.vux-header .vux-header-title,\r\n.vux-header .vux-header-right {\r\n    color: #999999!important;\n}\n.vux-header .vux-header-title {\r\n    margin: 0 45px!important;\n}\r\n","",{version:3,sources:["F:/OICS/src/components/common/OPosition.vue"],names:[],mappings:";AACA;;;IAGI,yBAAyB;CAC5B;AACD;IACI,yBAAyB;CAC5B",file:"OPosition.vue",sourcesContent:["\n.vux-header .vux-header-left,\r\n.vux-header .vux-header-title,\r\n.vux-header .vux-header-right {\r\n    color: #999999!important;\n}\n.vux-header .vux-header-title {\r\n    margin: 0 45px!important;\n}\r\n"],sourceRoot:""}])},IRDH:function(t,e,o){"use strict";function a(t){o("k0M7"),o("haCy")}var s=o("ABCa"),n=(s.a,String,{components:{XHeader:s.a},props:{title:String},data:function(){return{}},methods:{onBack:function(){this.$emit("on-back"),this.$router?this.$router.back():window.history.back()},onHomeMenu:function(){this.$emit("on-homeMenu"),this.$router.push({name:"index"})}}}),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("x-header",{staticClass:"header-bottom",attrs:{title:t.title,"left-options":{showBack:!1}}},[o("span",{staticClass:"iconfont icon-icon31",staticStyle:{"font-size":"20px"},attrs:{slot:"overwrite-left"},on:{click:t.onBack},slot:"overwrite-left"}),t._v(" "),o("span",{staticClass:"iconfont icon-shouye-copy",staticStyle:{"font-size":"24px"},attrs:{slot:"right"},on:{click:t.onHomeMenu},slot:"right"})])],1)},r=[],l={render:i,staticRenderFns:r},d=l,u=o("VU/8"),c=a,m=u(n,d,!1,c,"data-v-732e5379",null);e.a=m.exports},adXz:function(t,e,o){e=t.exports=o("FZ+f")(!0),e.push([t.i,"\n.track_details .weui-cells,\r\n.track_details .weui-btn {\r\n    font-size: 16px !important;\n}\r\n\r\n/*完成情况概述 上边框*/\n.x_textarea_weui_cell .weui-cell:before {\r\n    border-top: 0px solid #d9d9d9 !important;\n}\r\n","",{version:3,sources:["F:/OICS/src/oics/routines_track/track_details.vue"],names:[],mappings:";AACA;;IAEI,2BAA2B;CAC9B;;AAED,cAAc;AACd;IACI,yCAAyC;CAC5C",file:"track_details.vue",sourcesContent:["\n.track_details .weui-cells,\r\n.track_details .weui-btn {\r\n    font-size: 16px !important;\n}\r\n\r\n/*完成情况概述 上边框*/\n.x_textarea_weui_cell .weui-cell:before {\r\n    border-top: 0px solid #d9d9d9 !important;\n}\r\n"],sourceRoot:""}])},haCy:function(t,e,o){var a=o("FXN4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("62ffde96",a,!0,{})},k0M7:function(t,e,o){var a=o("rGJI");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("0fae7fd5",a,!0,{})},nXYi:function(t,e,o){e=t.exports=o("FZ+f")(!0),e.push([t.i,"\n.weui-cell[data-v-6471984e] {\r\n    padding: 15px 15px;\n}\r\n","",{version:3,sources:["F:/OICS/src/oics/routines_track/track_details.vue"],names:[],mappings:";AACA;IACI,mBAAmB;CACtB",file:"track_details.vue",sourcesContent:["\n.weui-cell[data-v-6471984e] {\r\n    padding: 15px 15px;\n}\r\n"],sourceRoot:""}])},qhHz:function(t,e,o){var a=o("nXYi");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("0728e5e4",a,!0,{})},rGJI:function(t,e,o){e=t.exports=o("FZ+f")(!0),e.push([t.i,"\n.header-bottom[data-v-732e5379] {\r\n    width: 100%;\r\n    position: absolute;\r\n    left: 0;\r\n    bottom: 0;\r\n    z-index: 500;\r\n    padding: 5px 0 ;\r\n    background-color: #fff;\n}\r\n\r\n","",{version:3,sources:["F:/OICS/src/components/common/OPosition.vue"],names:[],mappings:";AACA;IACI,YAAY;IACZ,mBAAmB;IACnB,QAAQ;IACR,UAAU;IACV,aAAa;IACb,gBAAgB;IAChB,uBAAuB;CAC1B",file:"OPosition.vue",sourcesContent:["\n.header-bottom[data-v-732e5379] {\r\n    width: 100%;\r\n    position: absolute;\r\n    left: 0;\r\n    bottom: 0;\r\n    z-index: 500;\r\n    padding: 5px 0 ;\r\n    background-color: #fff;\n}\r\n\r\n"],sourceRoot:""}])}});
//# sourceMappingURL=7.5a68066ab546532f195b.js.map